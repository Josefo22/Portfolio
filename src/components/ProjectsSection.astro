---
// ProjectsSection.astro
import { Icon } from 'astro-icon/components';

// Datos de proyectos
const projects = [
  {
    titleKey: 'pos-system-title',
    descriptionKey: 'pos-system-description',
    technologies: ['React', 'Node.js', 'MongoDB', 'Socket.IO', 'Electron'],
    image: 'https://placehold.co/600x400/10b981/FFFFFF?text=Sistema+POS',
    link: '#',
    categories: ['web', 'desktop']
  },
  {
    titleKey: 'hotel-system-title',
    descriptionKey: 'hotel-system-description',
    technologies: ['Angular', 'Firebase', 'NgRx', 'Bootstrap'],
    image: 'https://placehold.co/600x400/10b981/FFFFFF?text=Sistema+Hotel',
    link: '#',
    categories: ['web']
  },
  {
    titleKey: 'parking-crud-title',
    descriptionKey: 'parking-crud-description',
    technologies: ['Vue.js', 'Express', 'MySQL', 'Tailwind CSS'],
    image: 'https://placehold.co/600x400/10b981/FFFFFF?text=CRUD+Parqueadero',
    link: '#',
    categories: ['web']
  },
  {
    titleKey: 'ecommerce-title',
    descriptionKey: 'ecommerce-description',
    technologies: ['Next.js', 'Strapi', 'PostgreSQL', 'Stripe'],
    image: 'https://placehold.co/600x400/10b981/FFFFFF?text=E-commerce',
    link: '#',
    categories: ['web', 'ecommerce']
  },
  {
    titleKey: 'dashboard-title',
    descriptionKey: 'dashboard-description',
    technologies: ['React', 'D3.js', 'GraphQL', 'Material UI'],
    image: 'https://placehold.co/600x400/10b981/FFFFFF?text=Dashboard+Analytics',
    link: '#',
    categories: ['web', 'dashboard']
  },
  {
    titleKey: 'management-app-title',
    descriptionKey: 'management-app-description',
    technologies: ['React Native', 'Redux', 'Firebase', 'Native Base'],
    image: 'https://placehold.co/600x400/10b981/FFFFFF?text=App+Gestion',
    link: '#',
    categories: ['mobile']
  },
];

// Categorías únicas para los filtros
const categories = [...new Set(projects.flatMap(project => project.categories))];
---

<div id="projects-component" class="projects-section py-20 w-full block">
  <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
    <!-- Título de sección -->
    <div class="text-center mb-16">
      <p data-i18n="portfolio" class="text-lg font-medium text-emerald-500">
        Portfolio
      </p>
      <h2 data-i18n="projects-title" class="text-4xl font-bold text-gray-800 dark:text-white mt-2">
        Proyectos Destacados
      </h2>
      <div class="w-24 h-1 bg-emerald-500 mx-auto mt-4"></div>
      <p data-i18n="projects-description" class="mt-4 text-xl text-gray-600 dark:text-gray-300 max-w-3xl mx-auto">
        Explora algunos de mis proyectos recientes. Cada proyecto es único y resuelve problemas específicos
        de negocio utilizando las tecnologías más adecuadas.
      </p>
    </div>

    <!-- Filtros de categorías -->
    <div class="flex flex-wrap justify-center gap-3 mb-10">
      <button 
        class="filter-btn all-btn bg-emerald-500 text-white px-4 py-2 rounded-lg text-sm font-medium transition-all duration-300 hover:bg-emerald-600 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:ring-offset-2"
        data-category="all"
      >
        Todos
      </button>
      
      {categories.map((category) => (
        <button 
          class="filter-btn bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-white px-4 py-2 rounded-lg text-sm font-medium transition-all duration-300 hover:bg-gray-300 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-gray-300 dark:focus:ring-gray-500 focus:ring-offset-2"
          data-category={category}
        >
          {category.charAt(0).toUpperCase() + category.slice(1)}
        </button>
      ))}
    </div>

    <!-- Grid de proyectos -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 project-grid">
      {projects.map((project) => (
        <div class="project-card bg-white dark:bg-gray-800 rounded-xl overflow-hidden shadow-lg transition-all duration-300 hover:shadow-xl hover:transform hover:scale-105" data-categories={project.categories.join(' ')}>
          <div class="relative overflow-hidden project-image-container h-48">
            <img 
              src={project.image} 
              alt={project.titleKey} 
              class="w-full h-full object-cover transition-transform duration-700 hover:scale-110"
              onerror="this.src='https://placehold.co/600x400/10b981/FFFFFF?text=Imagen+No+Disponible';"
            />
            <div class="absolute inset-0 bg-gradient-to-t from-black/70 to-transparent opacity-0 hover:opacity-100 transition-opacity duration-300 flex items-end p-4">
              <a href={project.link} class="px-4 py-2 bg-emerald-500 text-white rounded-lg text-sm font-medium hover:bg-emerald-600 transition-colors duration-300" data-i18n="view-project">
                Ver proyecto
              </a>
            </div>
          </div>
          
          <div class="p-6">
            <h3 data-i18n={project.titleKey} class="text-xl font-bold text-gray-800 dark:text-white mb-2">
              {project.titleKey === 'pos-system-title' ? 'Sistema POS' : 
               project.titleKey === 'hotel-system-title' ? 'Sistema de Hotel' :
               project.titleKey === 'parking-crud-title' ? 'CRUD de Parqueadero' :
               project.titleKey === 'ecommerce-title' ? 'Plataforma E-commerce' :
               project.titleKey === 'dashboard-title' ? 'Dashboard Analítico' :
               project.titleKey === 'management-app-title' ? 'App de Gestión' : 
               project.titleKey}
            </h3>
            
            <p data-i18n={project.descriptionKey} class="text-gray-600 dark:text-gray-300 mb-4 line-clamp-2">
              {project.descriptionKey === 'pos-system-description' ? 'Sistema de punto de venta con gestión de inventario, ventas e informes.' :
               project.descriptionKey === 'hotel-system-description' ? 'Aplicación para gestión de reservas, pagos y clientes de hotel.' :
               project.descriptionKey === 'parking-crud-description' ? 'Sistema para administración de parqueaderos con registro y pagos de vehículos.' :
               project.descriptionKey === 'ecommerce-description' ? 'Plataforma completa con carrito de compras, pagos y panel administrativo.' :
               project.descriptionKey === 'dashboard-description' ? 'Dashboard interactivo para visualización de datos empresariales en tiempo real.' :
               project.descriptionKey === 'management-app-description' ? 'Aplicación para gestión de recursos y proyectos empresariales.' :
               project.descriptionKey}
            </p>
            
            <div class="flex flex-wrap gap-2 mb-4">
              {project.technologies.map((tech) => (
                <span class="text-xs font-medium px-2.5 py-0.5 rounded-full bg-emerald-100 text-emerald-800 dark:bg-emerald-900/30 dark:text-emerald-300">
                  {tech}
                </span>
              ))}
            </div>
            
            <div class="flex justify-between items-center">
              <div class="flex space-x-1">
                {project.categories.map((cat) => (
                  <span class="text-xs text-gray-500 dark:text-gray-400">#{cat}</span>
                ))}
              </div>
              <a href={project.link} class="text-emerald-500 hover:text-emerald-600 dark:hover:text-emerald-400 font-medium text-sm flex items-center transition-colors duration-300">
                <span data-i18n="view-project">Ver proyecto</span>
                <Icon name="mdi:arrow-right" class="w-4 h-4 ml-1" />
              </a>
            </div>
          </div>
        </div>
      ))}
    </div>
    
    <!-- Botón Ver Todos los Proyectos -->
    <div class="text-center mt-12">
      <a href="#" class="inline-flex items-center px-6 py-3 border border-emerald-500 text-emerald-500 hover:bg-emerald-50 dark:hover:bg-emerald-900/20 rounded-lg transition-colors duration-300 font-medium">
        <span data-i18n="view-all-projects">Ver todos los proyectos</span>
        <Icon name="mdi:arrow-right" class="w-5 h-5 ml-2" />
      </a>
    </div>
  </div>
</div>

<style>
  .projects-section {
    display: block !important;
    visibility: visible !important;
    opacity: 1 !important;
  }
  
  .project-card {
    transition: transform 0.3s ease, box-shadow 0.3s ease;
  }
  
  .project-card:hover {
    transform: translateY(-5px);
  }
  
  .project-image-container {
    position: relative;
  }
</style>

<script>
  // Asegurar que el componente de proyectos sea visible
  document.addEventListener('DOMContentLoaded', function() {
    const projectsComponent = document.getElementById('projects-component');
    if (projectsComponent) {
      projectsComponent.style.display = 'block';
      projectsComponent.style.visibility = 'visible';
      projectsComponent.style.opacity = '1';
    }
    
    // Filtrado de proyectos por categoría
    const filterButtons = document.querySelectorAll('.filter-btn');
    const projectCards = document.querySelectorAll('.project-card');
    
    filterButtons.forEach(button => {
      button.addEventListener('click', () => {
        // Quitar la clase activa de todos los botones
        filterButtons.forEach(btn => {
          btn.classList.remove('bg-emerald-500', 'text-white');
          btn.classList.add('bg-gray-200', 'dark:bg-gray-700', 'text-gray-800', 'dark:text-white');
        });
        
        // Añadir la clase activa al botón actual
        button.classList.remove('bg-gray-200', 'dark:bg-gray-700', 'text-gray-800', 'dark:text-white');
        button.classList.add('bg-emerald-500', 'text-white');
        
        const category = button.getAttribute('data-category') || 'all';
        
        // Filtrar proyectos
        projectCards.forEach(card => {
          if (category === 'all') {
            (card as HTMLElement).style.display = 'block';
          } else {
            const categories = card.getAttribute('data-categories')?.split(' ') || [];
            if (categories.includes(category)) {
              (card as HTMLElement).style.display = 'block';
            } else {
              (card as HTMLElement).style.display = 'none';
            }
          }
        });
      });
    });
  });
</script>